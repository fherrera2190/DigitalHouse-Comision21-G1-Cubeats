<!DOCTYPE html>
<html lang="en">
<%- include('./partials/head', { title : 'User profile' }) %>


<% if (locals.errors) { %>

<body class="profile modal-open" style="overflow: hidden; padding-right: 17px;">
  <% }else{ %>

  <body class="profile">

    <% } %>

    <%- include('./partials/header.ejs') %>
    <main class="profile__main ">
      <div class="main__container">
        <div class="row">
          <div class="col-md-3 ">
            <div class="d-flex flex-column align-items-center ">
              <div class="autor-profile mb-3">
                <img src="/img/users/<%= userDatos.image||'default-image.png' %>" alt="">
              </div>
              <p class="fs-3"><%= userDatos.username  %></p>
              <% if (locals.userLogged && locals.userLogged.username === userDatos.username) { %>
              <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#exampleModal"> Edit Profile</button>
              <% } %>
              <div class="d-flex w-100 justify-content-around  fs-3 profile__redes">
                <a href="#"><i class="fa-brands fa-youtube"></i></a>
                <a href="#"><i class="fa-brands fa-instagram"></i></a>
                <a href="#"><i class="fa-brands fa-square-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-tiktok"></i></a>
              </div>
            </div>
          </div>
          <div class="col-md-9">
            <div class="autor-page-cover ">
              <img class="profile-bg__img img-fluid" src="/img/users/<%= userDatos.cover||'defaultcover.jpg' %>" alt="">
            </div>
            <hr>
            <article>
              <h3>About Me</h3>
              <% if (userDatos.description) { %>
              <p><%= userDatos.description %></p>
              <% }else{ %>
              <p>No description...</p>
              <% } %>
            </article>
            <hr>
            <article>
              <div class="mb-5 d-flex flex-column flex-md-row justify-content-between align-items-center ">
                <h3>Beats Upload</h3>
                <% if (locals.userLogged && locals.userLogged.username === userDatos.username && locals.userLogged.role === 3){ %>
                <div class="mt-3 d-flex justify-content-center "> <a class="btn" href="/products/add">New Beat</a> </div>
                <% } %>
              </div>
              <% if (products.length>0) { %>
              <% products.forEach(product => { %>
              <div class="d-flex justify-content-center">
                <%- include('./partials/cardsProduct.ejs',{...product.dataValues})  %>
              </div>
              <%}) %>
              <% } else{%>
              <p>No beats uploaded yet...</p>
              <% } %>
            </article>
          </div>
        </div>
      </div>
    </main>
    <%- include('./partials/footer.ejs') %>
    <%- include('./partials/scripts.ejs') %>
    <%- include('./partials/formEditProfile.ejs')  %>


    <% if (locals.errors) { %>
    <div class="modal-backdrop fade show"></div>
    <% }%>
  </body>

</html>